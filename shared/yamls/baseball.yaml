###Baseball
- WORLD:
  - bonus_variables: [Bpalla_in_reset,Bpalla_zona_battitore,Bpallastrike,Boldstrike,Bnumstrike,Btuttiinposizione,percentuale_di_successo_battuta,xballd,yballd]
    Bpalla_zona_battitore: 'abs(xball)<0.5 and abs(yball)<0.5'
    Bpallastrike: 'yball<0'
    Boldstrike: Bpallastrike
    Bpalla_in_reset: 'palla_in_resetBall'
    Bnumstrike: '(Bnumstrike+if (not(Boldstrike) and Bpallastrike,0,1))'
    Btuttiinposizione: 'abs(xball)<0.2 and abs(yball-5)<0.2 and abs(xricevitore1-xbasericevitore1)<0.2 
    and abs(yricevitore1-ybasericevitore1)<0.2 and abs(xricevitore2-xbasericevitore2)<0.2 and 
    abs(yricevitore2-ybasericevitore2)<0.2'
    Btuttiinposizioneold: Btuttiinposizione
    Btuttiinposizioneoldold: Btuttiinposizioneold
    percentuale_di_successo_battuta: 'rndom(1.0,2.0)'
    xballD: xball
    yballD: yball
  AGENTS:
  - agent: Ball
    #VISIBLE AREA: ./battle/exp_t_visuale.txt
    #NEIGHBORHOOD =  ./battle/exp_t_visuale.txt
    #MONITORING = 0
    #COLLABORATIVE = 1
    states: [x,y,angle,xbase,ybase,palla_in_reset]
    control_commands: [v,theta,controllo_reset]
    INITIAL:
    - x: '0'
      y: '5'
      angle: '0'
      xbase: '0'
      ybase: '5'
      palla_in_reset: '1'
    STATE_START: STARTING
    DYNAMIC_MAP:
    - x: 'v*cos(theta)'
      y: 'v*sin(theta)'
      angle: '0'
      xbase: '0'
      ybase: '0'
      palla_in_reset: if(palla_in_reset>1,0,if(palla_in_reset<-1,0,controllo_reset))
    BEHAVIOR:
    - name: Ball 
      CONTROLLERS:
      - name: lancio
        v: 'if (v=0,0.7,v)'
        theta: -pi_greco/2 + rndom(-pi/16.0,pi/16.0)
        controllo_reset: '-10'
      - name: battuta
        v: '10-v/10'
        #Sto barando perchÃ¨ dovrei avere una dinamica che fa questa cosa e non un controllore
        theta: pi_greco/2 + rndom(-3.14/16,+3.14/16)
        controllo_reset: '0'
      - name: fine_corsa
        v: '0'
        theta: '0'
        controllo_reset: '0'
      - name: rilancio
        v: '5'
        theta: atan2(-y,-x)
        controllo_reset: '0'
      - name: reset
        v: 1*(ybase-y)
        theta: atan2(ybase-y,xbase-x)
        controllo_reset: '10'
      - name: stop
        v: 0
        theta: 0
        controllo_reset: '0'
      DISCRETE_STATES:
      - name: lancio
        controller: lancio
      - name: battuta
        controller: battuta
      - name: fine_corsa
        controller: fine_corsa
      - name: reset
        controller: reset
      - name: rilancio
        controller: rilancio
      - name: starting
        controller: stop
      - name: waiting
        controller: stop
      ENCODER:
      - TOPOLOGY:
          - topology: [palla_presa]
            palla_presa: 'abs(x-xi)<0.5 and abs(y-yi)<0.5'
        LAMBDA:
          - lambda: [Ttuttiinposizione,Lpalla_zona_battitore,Lfaul,Lfuoricampo,Lpallainposizionedilancio,LpallaBattuta]
            Lpalla_zona_battitore: 'Bpalla_zona_battitore=1'
            Lfaul: y<0
            Lfuoricampo: y>60
            Lpallainposizionedilancio: abs(x-0)<0.1 and abs(y-5)<0.1
            LpallaBattuta: percentuale_di_successo_battuta
            Ttuttiinposizione: 'Btuttiinposizione==1'
            #or Btuttiinposizioneold==1 or Btuttiinposizioneoldold==1'
      EVENTS:
      - events: [Ezonabattuta,Ereset,EpallaBattuta,Efuoricampo,Epresa,Epallaattesa,Etuttiinposizione] 
        Ezonabattuta: Lpalla_zona_battitore
        Ereset: '!Lpalla_zona_battitore Lfaul'
        EpallaBattuta: LpallaBattuta
        Efuoricampo: Lfuoricampo
        Epresa: palla_presa
        Epallaattesa: Lpallainposizionedilancio
        Etuttiinposizione: Ttuttiinposizione
      AUTOMATON:
      - name: ball
        LANCIO:
          - PROVA_BATTUTA: [Ezonabattuta]
            RESET: [Ereset]
        PROVA_BATTUTA:
          - BATTUTA: [EpallaBattuta]
            RESET: [!EpallaBattuta]
        BATTUTA:
          - WAITING: [Efuoricampo]
            RILANCIO: [Epresa]
        WAITING:
          - RILANCIO: [Epresa]
        RILANCIO:
          - RESET: [Ezonabattuta]
        RESET:
          - STARTING: [Epallaattesa]
        STARTING:
          - LANCIO: [Etuttiinposizione]
  - agent: Ricevitore1
    #VISIBLE AREA: ./battle/exp_t_visuale.txt
    #NEIGHBORHOOD =  ./battle/exp_t_visuale.txt
    #MONITORING = 0
    #COLLABORATIVE = 1
    states: [x,y,theta,xbase,ybase,palla_in_reset]
    control_commands: [v,w]
    INITIAL:
    - x: '10'
      y: '10'
      theta: '0'
      xbase: '10'
      ybase: '10'
      palla_in_reset: '0'
    STATE_START: WAITING
    DYNAMIC_MAP:
    - x: 'v*cos(theta)'
      y: 'v*sin(theta)'
      theta: 'w'
      xbase: 0
      ybase: 0
      palla_in_reset: '0'
    BEHAVIOR:
    - &ricevitore 
      name: ricevitore
      CONTROLLERS:
      - name: waiting
        v: 0
        w: 0
      - name: searching
        v: 2
        w: 5*sin(atan2(yballd-y,xballd-x)-theta)
      - name: rilancio
        v: 0
        w: 0
      - name: reset
        v: 1
        w: 5*sin(atan2(ybase-y,xbase-x)-theta)
      DISCRETE_STATES:
      - name: waiting
        controller: waiting
      - name: searching
        controller: searching
      - name: rilancio
        controller: rilancio
      - name: reset
        controller: reset
      - name: starting
        controller: waiting
      ENCODER:
      - TOPOLOGY:
          - topology:
        LAMBDA:
          - lambda: [Lpalla_vicina,Lpalla_presa,Linbase,Ltuttiinposizione,Lpalla_in_reset]
            Lpalla_vicina: 'abs(x-xballD)<5 and abs(y-yballD)<5'
            Lpalla_presa: 'abs(x-xballD)<0.5 and abs(y-yballD)<0.5'
            Linbase: 'abs(x-xbase)<0.1 and abs(y-ybase)<0.1'
            Ltuttiinposizione: 'Btuttiinposizione==1'
            #or Btuttiinposizioneold==1 or Btuttiinposizioneoldold==1'
            Lpalla_in_reset: 'Bpalla_in_reset==1'
      EVENTS:
      - events: [Epalla_vicina,Epalla_presa,Einbase,Etuttiinposizione,Epalla_in_reset]
        Epalla_vicina: Lpalla_vicina
        Epalla_presa: Lpalla_presa
        Einbase: Linbase
        Etuttiinposizione: Ltuttiinposizione
        Epalla_in_reset: Lpalla_in_reset
      AUTOMATON:
      - name: ricevitore
        WAITING:
          - SEARCHING: [Epalla_vicina]
        STARTING:
          - WAITING: [Etuttiinposizione]
        RESET:
          - STARTING: [Einbase]
        SEARCHING:
          - RILANCIO: [Epalla_presa]
            RESET: [Epalla_in_reset]
        RILANCIO:
          - RESET: [Epalla_presa,Epalla_in_reset]
          
  - agent: Ricevitore2
    #VISIBLE AREA: ./battle/exp_t_visuale.txt
    #NEIGHBORHOOD =  ./battle/exp_t_visuale.txt
    #MONITORING = 0
    #COLLABORATIVE = 1
    states: [x,y,theta,xbase,ybase,palla_in_reset]
    control_commands: [v,w]
    INITIAL:
    - x: '0'
      y: '20'
      theta: '0'
      xbase: '0'
      ybase: '20'
      palla_in_reset: '0'
    STATE_START: WAITING
    DYNAMIC_MAP:
    - x: 'v*cos(theta)'
      y: 'v*sin(theta)'
      theta: 'w'
      xbase: 0
      ybase: 0
      palla_in_reset: '0'
    BEHAVIOR:
    - *ricevitore 